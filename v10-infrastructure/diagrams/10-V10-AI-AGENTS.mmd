%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#FFEBEE',
    'primaryTextColor': '#C62828',
    'primaryBorderColor': '#E53935',
    'lineColor': '#424242',
    'secondaryColor': '#E1F5FE',
    'tertiaryColor': '#F3E5F5',
    'fontSize': '14px'
  }
}}%%

graph TB
    %% ============================================================================
    %% V10 AI AGENTS - 8 AUTONOMOUS AGENTS
    %% ============================================================================
    %% Version: 10.0 ULTIMATE
    %% Focus: 8 AI Agents for Autonomous Operations
    %% Date: 2025-11-04
    
    subgraph AGENT_SYSTEM["ğŸ¤– AGENT AI SYSTEM (VPS3 - 3GB RAM)"]
        direction TB
        
        subgraph ORCHESTRATOR["ğŸ§  AGENT ORCHESTRATOR"]
            LG_AGENT["ğŸ§  LANGGRAPH AGENT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Central Orchestrator<br/>1GB RAM | Port 8010<br/><br/>Responsibilities:<br/>â€¢ Route tasks to agents<br/>â€¢ Manage agent state<br/>â€¢ Handle errors<br/>â€¢ Coordinate workflows"]
            
            ZEP_AGENT["ğŸ§© ZEP AGENT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Agent Memory<br/>500MB | Port 8011<br/><br/>Stores:<br/>â€¢ Conversation history<br/>â€¢ Pattern storage<br/>â€¢ Agent learnings<br/>â€¢ Task history"]
            
            CONTEXTFORGE_AGENT["ğŸ”Œ CONTEXTFORGE AGENT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Internal MCP Gateway<br/>500MB | Port 8012<br/><br/>Provides:<br/>â€¢ Tool routing<br/>â€¢ API aggregation<br/>â€¢ Internal MCPs"]
        end
        
        subgraph AGENTS["ğŸ¤– 8 AUTONOMOUS AI AGENTS (1.5GB total)"]
            direction LR
            
            AGENT_DEVOPS["ğŸ”§ DEVOPS COMMANDER<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>190MB RAM<br/><br/>Responsibilities:<br/>â€¢ Deploy services<br/>â€¢ Restart containers<br/>â€¢ Scale resources<br/>â€¢ Update configs<br/><br/>Tools:<br/>â€¢ Coolify API<br/>â€¢ Docker API<br/>â€¢ Headscale VPN<br/><br/>Success: <5 min deploy"]
            
            AGENT_DATA["ğŸ“Š DATA ORCHESTRATOR<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>190MB RAM<br/><br/>Responsibilities:<br/>â€¢ Monitor CDC pipeline<br/>â€¢ Trigger backups<br/>â€¢ Data quality checks<br/>â€¢ ETL management<br/><br/>Tools:<br/>â€¢ Neo4j API<br/>â€¢ LanceDB API<br/>â€¢ PostgreSQL<br/><br/>Success: 100% backup"]
            
            AGENT_ALERT["ğŸš¨ ALERT COMMANDER<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>190MB RAM<br/><br/>Responsibilities:<br/>â€¢ Monitor Alerta<br/>â€¢ Triage alerts<br/>â€¢ Auto-fix issues<br/>â€¢ Escalate critical<br/><br/>Tools:<br/>â€¢ Alerta API<br/>â€¢ Prometheus<br/>â€¢ Sentry<br/><br/>Success: 70% auto-fix"]
            
            AGENT_FINANCE["ğŸ’° FINANCE TRACKER<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>190MB RAM<br/><br/>Responsibilities:<br/>â€¢ Track daily costs<br/>â€¢ Monitor API usage<br/>â€¢ Alert on overruns<br/>â€¢ Generate reports<br/><br/>Tools:<br/>â€¢ Mercury API<br/>â€¢ Stripe API<br/>â€¢ Prometheus<br/><br/>Success: 100% accuracy"]
            
            AGENT_DOC["ğŸ“ DOC WRITER<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>190MB RAM<br/><br/>Responsibilities:<br/>â€¢ Auto-gen API docs<br/>â€¢ Update diagrams<br/>â€¢ Create runbooks<br/>â€¢ Maintain changelog<br/><br/>Tools:<br/>â€¢ GitHub API<br/>â€¢ Notion API<br/>â€¢ Mermaid<br/><br/>Success: <7 days fresh"]
            
            AGENT_COMPLIANCE["âš–ï¸ COMPLIANCE GUARDIAN<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>190MB RAM<br/><br/>Responsibilities:<br/>â€¢ GDPR checks<br/>â€¢ Security audits<br/>â€¢ Access control<br/>â€¢ Data residency<br/><br/>Tools:<br/>â€¢ Trivy scanner<br/>â€¢ Vaultwarden<br/>â€¢ Logto<br/><br/>Success: 100% compliance"]
            
            AGENT_TEST["ğŸ§ª TEST RUNNER<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>190MB RAM<br/><br/>Responsibilities:<br/>â€¢ Run E2E tests<br/>â€¢ API integration<br/>â€¢ Load testing<br/>â€¢ Performance bench<br/><br/>Tools:<br/>â€¢ Playwright<br/>â€¢ k6<br/>â€¢ Gitea Actions<br/><br/>Success: >80% coverage"]
            
            AGENT_LEARNING["ğŸ“ SYSTEM LEARNER<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>190MB RAM<br/><br/>Responsibilities:<br/>â€¢ Analyze patterns<br/>â€¢ Detect anomalies<br/>â€¢ Suggest optimizations<br/>â€¢ Update skills<br/><br/>Tools:<br/>â€¢ Neo4j Agent<br/>â€¢ LanceDB Agent<br/>â€¢ Prometheus<br/><br/>Success: >90% detection"]
        end
    end
    
    subgraph AGENT_DBS["ğŸ—„ï¸ AGENT DATABASES (VPS2 - 6GB RAM)"]
        direction LR
        
        NEO4J_AGENT["ğŸ”µ NEO4J AGENT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>1M triples<br/>2GB RAM<br/><br/>Stores:<br/>â€¢ Incident graph<br/>â€¢ Pattern relationships<br/>â€¢ Agent knowledge<br/>â€¢ System topology"]
        
        LANCEDB_AGENT["ğŸš€ LANCEDB AGENT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>400k vectors<br/>300MB RAM â­ 6.7x less!<br/><br/>Stores:<br/>â€¢ Agent embeddings<br/>â€¢ Similarity search<br/>â€¢ Pattern matching<br/>â€¢ Anomaly detection"]
        
        PG_AGENT["ğŸ—„ï¸ POSTGRESQL AGENT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>2 databases<br/>1GB RAM<br/><br/>Stores:<br/>â€¢ Agent state<br/>â€¢ Task queue<br/>â€¢ Audit logs<br/>â€¢ Metrics"]
        
        REDIS_AGENT["ğŸ”´ REDIS AGENT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Task Queue<br/>500MB<br/><br/>Provides:<br/>â€¢ Task queue<br/>â€¢ Pub/Sub<br/>â€¢ Cache<br/>â€¢ Rate limiting"]
    end
    
    subgraph OBSERVABILITY["ğŸ“Š OBSERVABILITY (VPS1)"]
        direction LR
        
        ALERTA["ğŸš¨ ALERTA<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Alert Hub<br/>800MB<br/><br/>Aggregates:<br/>â€¢ Prometheus alerts<br/>â€¢ Sentry errors<br/>â€¢ Loki warnings<br/>â€¢ Custom alerts"]
        
        PROMETHEUS["ğŸ“ˆ PROMETHEUS<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Metrics<br/>2GB<br/><br/>Monitors:<br/>â€¢ Agent health<br/>â€¢ Task success rate<br/>â€¢ Response time<br/>â€¢ Resource usage"]
        
        SENTRY["ğŸ› SENTRY<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Error Tracking<br/>1GB<br/><br/>Tracks:<br/>â€¢ Agent errors<br/>â€¢ Stack traces<br/>â€¢ Error frequency<br/>â€¢ Impact analysis"]
    end
    
    subgraph INFRASTRUCTURE["ğŸ”§ INFRASTRUCTURE (VPS1)"]
        direction LR
        
        COOLIFY["ğŸš€ COOLIFY<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>PaaS Manager<br/>2GB<br/><br/>Manages:<br/>â€¢ Deployments<br/>â€¢ Containers<br/>â€¢ Services<br/>â€¢ Configs"]
        
        HEADSCALE["ğŸŒ HEADSCALE<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>VPN Mesh<br/>200MB<br/><br/>Provides:<br/>â€¢ Secure network<br/>â€¢ Inter-VPS comm<br/>â€¢ Access control"]
    end
    
    subgraph CODE_EXECUTION["ğŸ’» CODE EXECUTION (VPS4 - 8GB RAM) â­ V10"]
        direction LR
        
        SKYPILOT["ğŸš€ SKYPILOT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Code Sandbox<br/>8GB RAM<br/><br/>Features:<br/>â€¢ Python/JS/Multi-lang<br/>â€¢ Session pooling<br/>â€¢ Persistent volumes<br/>â€¢ 300ms execution<br/>â€¢ $0 usage cost"]
        
        K3S["â˜¸ï¸ K3S<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Kubernetes<br/>500MB<br/><br/>Manages:<br/>â€¢ Execution pods<br/>â€¢ Auto-scaling<br/>â€¢ Resource limits"]
    end
    
    subgraph EXTERNAL["â˜ï¸ EXTERNAL SERVICES"]
        direction LR
        
        MERCURY["ğŸ’³ MERCURY<br/>Banking API"]
        STRIPE["ğŸ’³ STRIPE<br/>Payment API"]
        GITHUB["ğŸ™ GITHUB<br/>Code API"]
        NOTION["ğŸ““ NOTION<br/>Workspace API"]
    end
    
    %% Connections - Orchestrator to Agents
    LG_AGENT --> AGENT_DEVOPS
    LG_AGENT --> AGENT_DATA
    LG_AGENT --> AGENT_ALERT
    LG_AGENT --> AGENT_FINANCE
    LG_AGENT --> AGENT_DOC
    LG_AGENT --> AGENT_COMPLIANCE
    LG_AGENT --> AGENT_TEST
    LG_AGENT --> AGENT_LEARNING
    
    %% Connections - Agents to Orchestrator (bidirectional)
    AGENT_DEVOPS --> LG_AGENT
    AGENT_DATA --> LG_AGENT
    AGENT_ALERT --> LG_AGENT
    AGENT_FINANCE --> LG_AGENT
    AGENT_DOC --> LG_AGENT
    AGENT_COMPLIANCE --> LG_AGENT
    AGENT_TEST --> LG_AGENT
    AGENT_LEARNING --> LG_AGENT
    
    %% Connections - Orchestrator to Databases
    LG_AGENT --> NEO4J_AGENT
    LG_AGENT --> LANCEDB_AGENT
    LG_AGENT --> PG_AGENT
    LG_AGENT --> REDIS_AGENT
    ZEP_AGENT --> NEO4J_AGENT
    ZEP_AGENT --> LANCEDB_AGENT
    
    %% Connections - Alert Agent to Alerta
    AGENT_ALERT --> ALERTA
    ALERTA -.->|Read alerts| AGENT_ALERT
    AGENT_ALERT --> PROMETHEUS
    AGENT_ALERT --> SENTRY
    
    %% Connections - DevOps Agent to Infrastructure
    AGENT_DEVOPS --> COOLIFY
    AGENT_DEVOPS --> HEADSCALE
    
    %% Connections - Data Agent to Databases
    AGENT_DATA --> NEO4J_AGENT
    AGENT_DATA --> LANCEDB_AGENT
    AGENT_DATA --> PG_AGENT
    
    %% Connections - Finance Agent to External
    AGENT_FINANCE --> MERCURY
    AGENT_FINANCE --> STRIPE
    
    %% Connections - Doc Agent to External
    AGENT_DOC --> GITHUB
    AGENT_DOC --> NOTION
    
    %% Connections - Learning Agent to Databases
    AGENT_LEARNING --> NEO4J_AGENT
    AGENT_LEARNING --> LANCEDB_AGENT
    AGENT_LEARNING --> PROMETHEUS
    
    %% Connections - Product AI to VPS4 Code Execution â­ V10
    LG_AGENT -.->|Execute code| SKYPILOT
    AGENT_TEST --> SKYPILOT
    
    %% Styling
    classDef orchestratorStyle fill:#E1F5FE,stroke:#0277BD,stroke-width:3px
    classDef agentStyle fill:#FFEBEE,stroke:#C62828,stroke-width:2px
    classDef dbStyle fill:#FFF3E0,stroke:#F57C00,stroke-width:2px
    classDef observabilityStyle fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px
    classDef infraStyle fill:#E8F5E9,stroke:#388E3C,stroke-width:2px
    classDef vps4Style fill:#E3F2FD,stroke:#1976D2,stroke-width:3px
    classDef externalStyle fill:#FFCCBC,stroke:#E64A19,stroke-width:2px
    
    class LG_AGENT,ZEP_AGENT,CONTEXTFORGE_AGENT orchestratorStyle
    class AGENT_DEVOPS,AGENT_DATA,AGENT_ALERT,AGENT_FINANCE,AGENT_DOC,AGENT_COMPLIANCE,AGENT_TEST,AGENT_LEARNING agentStyle
    class NEO4J_AGENT,LANCEDB_AGENT,PG_AGENT,REDIS_AGENT dbStyle
    class ALERTA,PROMETHEUS,SENTRY observabilityStyle
    class COOLIFY,HEADSCALE infraStyle
    class SKYPILOT,K3S vps4Style
    class MERCURY,STRIPE,GITHUB,NOTION externalStyle
