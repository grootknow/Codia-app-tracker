%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#E3F2FD',
    'primaryTextColor': '#1565C0',
    'primaryBorderColor': '#1976D2',
    'lineColor': '#424242',
    'secondaryColor': '#F3E5F5',
    'tertiaryColor': '#E8F5E9',
    'fontSize': '16px'
  }
}}%%

graph TB
    %% ============================================================================
    %% VPS4: CODE EXECUTION - "AI CÃ“ MÃY TÃNH RIÃŠNG" BREAKTHROUGH ğŸ”¥
    %% ============================================================================
    %% PARENT: 00-MASTER-OVERVIEW.mmd
    %% PHILOSOPHY: AI execute code tháº­t, khÃ´ng giá»›i háº¡n!
    %% BREAKTHROUGH: 7x faster Modal, $0 cost, unlimited sessions
    
    %% ============================================================================
    %% USER REQUEST
    %% ============================================================================
    
    FOUNDER["ğŸ‘¤ FOUNDER<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>'Analyze this CSV<br/>with pandas and plot<br/>sales trends'"]
    
    LOBECHAT["ğŸ’¬ LOBECHAT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Parse natural language<br/>Extract intent"]
    
    %% ============================================================================
    %% AI PROCESSING
    %% ============================================================================
    
    LANGGRAPH["ğŸ”„ LANGGRAPH PRODUCT<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>VPS3 | 2GB RAM<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>1ï¸âƒ£ Understand request<br/>2ï¸âƒ£ Generate Python code:<br/><br/>```python<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/><br/>df = pd.read_csv('sales.csv')<br/>df.groupby('month')['revenue']<br/>  .sum().plot(kind='bar')<br/>plt.savefig('sales_trend.png')<br/>```<br/><br/>3ï¸âƒ£ Route to SkyPilot"]
    
    %% ============================================================================
    %% CODE EXECUTION SANDBOX
    %% ============================================================================
    
    subgraph VPS4["ğŸ’» VPS4: CODE EXECUTION (8GB) - $7-10/mo"]
        direction TB
        
        SKYPILOT_CONTROL["ğŸš€ SKYPILOT CONTROL<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Orchestrator<br/>500MB RAM<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>âœ… Route to warm pod<br/>âœ… Manage sessions<br/>âœ… Monitor resources<br/>âœ… Handle failures"]
        
        K3S["â˜¸ï¸ K3S KUBERNETES<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Lightweight K8s<br/>500MB RAM<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>âœ… Container orchestration<br/>âœ… Auto-scaling<br/>âœ… Health checks"]
        
        subgraph WARM_POOL["ğŸ”¥ WARM POD POOL (7GB) - NO COLD START!"]
            direction LR
            
            POD_PYTHON["ğŸ PYTHON POD<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Warm pool: 2 containers<br/>3GB RAM each<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Pre-installed:<br/>âœ… pandas, numpy<br/>âœ… matplotlib, seaborn<br/>âœ… scikit-learn<br/>âœ… tensorflow, pytorch<br/>âœ… requests, beautifulsoup<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>âš¡ 300ms latency<br/>ğŸ’° $0 usage cost"]
            
            POD_JS["ğŸ“œ JAVASCRIPT POD<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Warm pool: 2 containers<br/>2GB RAM each<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Pre-installed:<br/>âœ… Node.js 20<br/>âœ… npm packages<br/>âœ… axios, lodash<br/>âœ… cheerio, puppeteer<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>âš¡ 300ms latency<br/>ğŸ’° $0 usage cost"]
        end
        
        PERSISTENT_VOL["ğŸ’¾ PERSISTENT VOLUMES<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>1GB storage<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>âœ… Data survives restarts<br/>âœ… Session state preserved<br/>âœ… Share between pods<br/>âœ… Backup to R2"]
    end
    
    %% ============================================================================
    %% RESULTS
    %% ============================================================================
    
    RESULTS["ğŸ“Š RESULTS<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>DataFrame:<br/>month | revenue<br/>Jan   | $125k<br/>Feb   | $143k<br/>Mar   | $167k<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Chart: sales_trend.png<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â±ï¸ Total time: 2.3s<br/>ğŸ’° Cost: $0"]
    
    %% ============================================================================
    %% COMPARISON
    %% ============================================================================
    
    subgraph COMPARISON["ğŸ“Š VS MODAL / JUPYTER"]
        direction TB
        
        MODAL["âŒ MODAL (Cloud)<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â±ï¸ Cold start: 2-5s<br/>â±ï¸ Execution: 2s<br/>â±ï¸ Total: 4-7s<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>ğŸ’° $0.50/hour<br/>ğŸ’° ~$360/mo<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>âŒ 24h timeout<br/>âŒ No persistent state<br/>âŒ Quotas & limits"]
        
        SKYPILOT_STATS["âœ… SKYPILOT (Self-hosted)<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â±ï¸ Cold start: 0ms (warm!)<br/>â±ï¸ Execution: 300ms<br/>â±ï¸ Total: 300ms<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>ğŸ’° $0 usage cost<br/>ğŸ’° $7-10/mo fixed<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>âœ… UNLIMITED time<br/>âœ… Persistent state<br/>âœ… NO quotas, NO limits<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>ğŸ”¥ 7x FASTER!<br/>ğŸ”¥ 36x CHEAPER!"]
    end
    
    %% ============================================================================
    %% CONNECTIONS - COMPLETE FLOW
    %% ============================================================================
    
    %% 1ï¸âƒ£ Founder â†’ AI
    FOUNDER -->|Natural language| LOBECHAT
    LOBECHAT --> LANGGRAPH
    
    %% 2ï¸âƒ£ AI â†’ Code Execution
    LANGGRAPH -->|Python code| SKYPILOT_CONTROL
    SKYPILOT_CONTROL --> K3S
    K3S -->|Route to warm pod| POD_PYTHON
    
    %% 3ï¸âƒ£ Execution
    POD_PYTHON -->|Save results| PERSISTENT_VOL
    PERSISTENT_VOL -->|Load data| POD_PYTHON
    
    %% 4ï¸âƒ£ Results back
    POD_PYTHON -->|Results| SKYPILOT_CONTROL
    SKYPILOT_CONTROL -->|Format| LANGGRAPH
    LANGGRAPH -->|Response| LOBECHAT
    LOBECHAT -->|Display| RESULTS
    RESULTS -->|Show to| FOUNDER
    
    %% ============================================================================
    %% STYLING
    %% ============================================================================
    
    classDef founderStyle fill:#E3F2FD,stroke:#1976D2,stroke-width:4px
    classDef interfaceStyle fill:#E1F5FE,stroke:#0277BD,stroke-width:3px
    classDef aiStyle fill:#F3E5F5,stroke:#7B1FA2,stroke-width:3px
    classDef codeStyle fill:#E8F5E9,stroke:#388E3C,stroke-width:4px
    classDef resultStyle fill:#FFF3E0,stroke:#F57C00,stroke-width:3px
    classDef comparisonStyle fill:#FFEBEE,stroke:#C62828,stroke-width:2px
    
    class FOUNDER founderStyle
    class LOBECHAT interfaceStyle
    class LANGGRAPH aiStyle
    class SKYPILOT_CONTROL,K3S,POD_PYTHON,POD_JS,PERSISTENT_VOL codeStyle
    class RESULTS resultStyle
    class MODAL,SKYPILOT_STATS comparisonStyle
